### Questions API Testing
### =====================
### Use this file with the VSCode REST Client extension
### Install: https://marketplace.visualstudio.com/items?itemName=humao.rest-client

### Variables (adjust these for your environment)
### -----------------------------------------------
### To get test IDs after running `npx prisma db seed`:
###
### Option 1: Prisma Studio (GUI)
###   npx prisma studio
###   Then browse Sessions and Users tables
###
### Option 2: Database query
###   npx prisma db execute --stdin <<< "SELECT id, title, \"isSubmissionsEnabled\" FROM \"Session\";"
###   npx prisma db execute --stdin <<< "SELECT id, name, email FROM \"User\";"
###
### Note: The activeSession (join code "ABC123") has isSubmissionsEnabled=true
###       The scheduledSession has isSubmissionsEnabled=false (will reject questions)
### -----------------------------------------------

@baseUrl = http://localhost:3000
@sessionId = cml9o5eg4000eo24iuh3nfiab
@authorId = cml9o5efn0002o24ibid2bqqx

### ---------------------------------------------------------------------------
### Health Check (verify server is running)
### ---------------------------------------------------------------------------

GET {{baseUrl}}/api/health

### ---------------------------------------------------------------------------
### GET Questions - Fetch all questions for a session
### ---------------------------------------------------------------------------

### Get all questions for a session
GET {{baseUrl}}/api/sessions/{{sessionId}}/questions

### ---------------------------------------------------------------------------
### GET Questions - With filters
### ---------------------------------------------------------------------------

### Get only PUBLIC questions
GET {{baseUrl}}/api/sessions/{{sessionId}}/questions?visibility=PUBLIC

### Get only INSTRUCTOR_ONLY questions
GET {{baseUrl}}/api/sessions/{{sessionId}}/questions?visibility=INSTRUCTOR_ONLY

### Get only OPEN questions
GET {{baseUrl}}/api/sessions/{{sessionId}}/questions?status=OPEN

### Get only ANSWERED questions
GET {{baseUrl}}/api/sessions/{{sessionId}}/questions?status=ANSWERED

### Get only RESOLVED questions
GET {{baseUrl}}/api/sessions/{{sessionId}}/questions?status=RESOLVED

### Combine filters: PUBLIC + OPEN
GET {{baseUrl}}/api/sessions/{{sessionId}}/questions?visibility=PUBLIC&status=OPEN

### ---------------------------------------------------------------------------
### POST Questions - Create new questions
### ---------------------------------------------------------------------------

### Create a basic public question
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "content": "What is the time complexity of binary search?",
  "authorId": "{{authorId}}"
}

### Create an anonymous question
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "content": "I don't understand the recursion example, can you explain it again?",
  "authorId": "{{authorId}}",
  "isAnonymous": true
}

### Create an instructor-only question (only TAs/Professors see it)
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "content": "Should we cover dynamic programming in more depth?",
  "authorId": "{{authorId}}",
  "visibility": "INSTRUCTOR_ONLY"
}

### Create a question linked to a specific slide
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "content": "On slide 5, what does the arrow notation mean?",
  "authorId": "{{authorId}}",
  "slideId": "YOUR_SLIDE_ID_HERE"
}

### Create question with all options
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "content": "This is a fully configured question with all options set",
  "authorId": "{{authorId}}",
  "visibility": "PUBLIC",
  "isAnonymous": false,
  "slideId": null
}

### ---------------------------------------------------------------------------
### Error Cases (for testing validation)
### ---------------------------------------------------------------------------

### Error: Content too short (less than 5 characters)
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "content": "Hi",
  "authorId": "{{authorId}}"
}

### Error: Missing content
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "authorId": "{{authorId}}"
}

### Error: Missing authorId
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "content": "This question has no author ID"
}

### Error: Invalid visibility
POST {{baseUrl}}/api/sessions/{{sessionId}}/questions
Content-Type: application/json

{
  "content": "This question has an invalid visibility setting",
  "authorId": "{{authorId}}",
  "visibility": "PRIVATE"
}

### Error: Session not found
POST {{baseUrl}}/api/sessions/nonexistent-session-id/questions
Content-Type: application/json

{
  "content": "This should fail because session doesn't exist",
  "authorId": "{{authorId}}"
}
